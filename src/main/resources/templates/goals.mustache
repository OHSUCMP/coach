{{#layout}}
    {{#title}}{{applicationName}} - Goals{{/title}}
    {{#head}}
        <script type="text/javascript" src="/js/form.js"></script>
        <link rel="stylesheet" href="/css/form.css" />

<!--        <link rel="stylesheet" href="css/recommendations.css"/>-->
<!--        <script type="text/javascript" src="js/recommendations.js"></script>-->

        <script type="text/javascript" src="/js/goals.js"></script>
        <link rel="stylesheet" href="/css/goals.css"/>

        <script type="text/javascript">
            $(document).ready(function () {
                enableHover('#goalsTable .link');
            });

            $(document).on('click', '#goalsTable .markInProgress.link', function() {
                updateStatus(this, 'IN_PROGRESS');
            });

            $(document).on('click', '#goalsTable .markAchieved.link', function() {
                updateStatus(this, 'ACHIEVED');
            });

            $(document).on('click', '#goalsTable .markNotAchieved.link', function() {
                updateStatus(this, 'NOT_ACHIEVED');
            });
        </script>
    {{/head}}
    {{#menuItems}}
        <li><a href="/">Patient Portal</a></li>
        <li class="selected"><a href="/goals">My Goals</a></li>
        <li><a href="/bp-readings">Home BP Readings</a></li>
        <li><a href="/medications">My Medications</a></li>
        <li><a href="/preferences">My Preferences</a></li>
<!--        <li><a href="/feedback">Provider Feedback</a></li>-->
    {{/menuItems}}
    {{#content}}
        <table class="content">
            <tr>
                <td id="patientInfo">
                    <table style="margin-left: 50px">
                        <tr>
                            <td rowspan="2">
                                <span class="circle" style="background-color: #b3fff0">&nbsp;</span>
                            </td>
                            <td colspan="2">
                                <span style="font-size: x-large">{{patient.name}}</span>
                            </td>
                        </tr>
                        <tr>
                            <td>{{patient.age}} years</td>
                            <td>{{patient.gender}}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        {{#bpGoal}}
            <table id="bpContent" class="content">
                <tr>
                    <td class="heading">
                        My Blood Pressure Goal
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="bpGoal">
                            My current Blood Pressure goal is
                            <div id="bpDisplay">
                                <strong>{{systolicTarget}}</strong> / <strong>{{diastolicTarget}}</strong>
                                (<span id="showEditBP">Edit</span>)
                                <br/>
                                Current status: <strong>{{achievementStatus}}</strong>
                            </div>
                            <div id="bpEdit" class="hidden">
                                <input type='text' class='systolic' placeholder='Systolic' value="{{systolicTarget}}" />
                                /
                                <input type='text' class='diastolic' placeholder='Diastolic' value="{{diastolicTarget}}" />
                                (<span id="hideEditBP">View</span>)
                            </div>
                            <div class="buttonContainer">
                                <div id="updateNote"></div>
                                <div id="updateBPGoal" class="button">Update</div>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        {{/bpGoal}}

        <table class="content">
            <tr>
                <td class="heading">
                    My Other Goals
                </td>
            </tr>
            <tr>
                <td>
                    <table id="goalsTable" class="data">
                        <tr id="goalsTableHeader">
                            <th>Goal</th>
                            <th>Status</th>
                            <th>Created Date</th>
                            <th>&nbsp;</th>
                        </tr>
                        {{! note : keep this section synced with goals.js:appendRecordToTable(obj) }}
                        {{#goals}}
                            <tr class='goal data' data-extGoalId='{{extGoalId}}'>
                                <td>{{goalText}}</td>
                                <td class="status">
                                    {{achievementStatus}}
                                </td>
                                <td>{{createdDate}}</td>
                                <td class="actions">
                                    {{! this should be kept synchronized with goals.js:buildActionsHTML(status) }}
                                    {{#isInProgress}}
                                        <div class="markAchieved link">Mark Achieved</div>
                                        <div class="markNotAchieved link">Mark Not Achieved</div>
                                    {{/isInProgress}}
                                    {{^isInProgress}}
                                        <div class="markInProgress link">Mark In Progress</div>
                                    {{/isInProgress}}
                                </td>
                            </tr>
                            <tr class="goal history" data-extGoalId='{{extGoalId}}'>
                                <td colspan="5">
                                    <table class="no-spacing">
                                        <tr class="goalHistoryHeader">
                                            <th>Achievement Status</th>
                                            <th>Date</th>
                                        </tr>
                                        {{#history}}
                                            <tr>
                                                <td>{{achievementStatus}}</td>
                                                <td>{{createdDate}}</td>
                                            </tr>
                                        {{/history}}
                                    </table>
                                </td>
                            </tr>
                            </tr>
                        {{/goals}}
                    </table>
                </td>
            </tr>
        </table>
    {{/content}}
{{/layout}}